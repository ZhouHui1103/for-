# 指标体系规范 (v1.1)

---

## 1. 总则

### 1.1 目的

为了在我司建立一套统一、规范、可追溯的数据指标体系，确保各业务线、各部门之间对指标的定义、计算和解读保持一致，消除数据二义性，提升数据驱动决策的效率和准确性，特制定本规范。

### 1.2 适用范围

本规范适用于公司所有业务线的新增指标定义、已有指标梳理、以及基于指标进行的数据分析、报表开发和业务沟通。

---

## 2. 指标的分类与视角

### 2.1 指标分类

所有指标必须归属为以下三类之一，以明确其业务衡量目的。

- **过程指标 (Process)**: 衡量业务流程的**效率与健康度**。它回答“我们做得快不快，顺不顺畅？”。
  - *示例*: `订单分配时长`、`用户激活漏斗转化率`。
- **结果指标 (Outcome)**: 衡量业务动作的**产出与效果**。它回答“我们做完了多少，效果好不好？”。
  - *示例*: `有效订单数`、`客户满意度评分`、`核心功能使用率`。
- **财务指标 (Financial)**: 衡量业务活动的**商业回报与价值**。它回答“我们赚了还是亏了，这件事值不值钱？”。
  - *示例*: `流水 (GMV)`、`利润`、`利润率`、`客单价 (AOV)`、`客户生命周期价值 (LTV)`。

### 2.2 核心度量视角

任何指标都可以从以下两种基础视角进行度量，以满足不同的分析需求。

- **存量 (Stock)**: 描述在**特定时间点**的静态快照值。
  - *示例*: `月末总用户数`、`当前在库商品数`。
- **增量 (Flow / Delta)**: 描述在**特定时间段**内的变化量，是“单位时间量内增量视角”的核心。
  - *示例*: `本周新增用户数` (周期内变动量)、`昨日活跃用户数`。

---

## 3. 指标的结构与拆解

### 3.1 指标树 (Metric Tree)

任何一个核心业务指标（特别是结果指标和财务指标），都应通过“公式法”进行结构化拆解，形成一个层级清晰的“指标树”。这有助于将一个宏观目标（如提升收入）拆解为多个可执行的子目标。

### 3.2 拆解示例

以“销售收入”为例，其指标树可拆解如下：

- **L1: 销售收入** `(核心指标)`
  - **L2: 订单量**
    - **L3**: 新客订单量
    - **L3**: 老客订单量
  - **L2: 客单价**
    - **L3**: 平均订单金额
    - **L3**: 优惠后金额
  - **L2: 支付转化率**
    - **L3**: 下单-支付转化率
    - **L3**: 支付成功率

---

## 4. 指标元数据定义规范 (The "Indicator ID Card")

**所有指标在被创建和应用时，都必须拥有一个清晰、完备的元数据档案（即“指标身份证”），以杜绝歧义，并确保一切最终可以回到底表（L2表格）。**

### 4.1 指标元数据模板

| 要素 | 说明 | 示例 (以“日新增用户数”为例) |
| :--- | :--- | :--- |
| **指标名称** | 指标的唯一、通用名称。 | 日新增用户数 |
| **关联对象** | **该指标所衡量的核心业务对象，必须能映射到L2层底表。** | `用户 (User)` |
| **业务定义** | 用通俗的业务语言描述指标的含义。 | 当天在本平台内首次完成注册的用户数量。 |
| **计算逻辑** | 描述指标的数学计算公式或伪代码。 | `COUNT(DISTINCT user_id) WHERE is_first_register_date = '当天'` |
| **统计粒度** | 指标聚合的时间单位。 | `日` (也可按需聚合为 `周` / `月`) |
| **分析维度** | 可用于对该指标进行切片、下钻分析的业务属性。 | `注册来源渠道`、`用户所在地区`、`使用的设备终端` |
| **数据来源** | 指标计算所依赖的最底层数据表（事实表）。 | `dwd_user_register_log` |

---

## 5. 指标落地映射规范 (The Mapping SOP)

此部分定义了将一个已完成元数据定义的“逻辑指标”，转化为可被执行的“物理指标”的标准流程。

### 5.1 步骤一：确定数据来源（事实表）

- **要求**: 每个指标必须能唯一追溯到一个或多个底层事实表，这些事实表是对L2业务对象的物理实现。
- **示例**: `支付金额` → `fact_order_paid`

### 5.2 步骤二：确定计算字段

- **要求**: 明确指标计算逻辑中，涉及的具体数据库字段。
- **示例**: `SUM(order_amount)` 中，计算字段为 `order_amount`。

### 5.3 步骤三：确定维度字段

- **要求**: 明确指标分析维度所对应的数据库字段。
- **示例**: `注册来源渠道`维度 → 对应 `fact_user_register` 表中的 `channel_id` 字段。

### 5.4 步骤四：明确统计口径（过滤条件）

- **要求**: 必须用精确的 `WHERE` 条件来定义指标的统计范围，避免“野数据”。
- **示例**: `支付订单数` 的口径必须是 `WHERE order_status = 'paid' AND payment_time IS NOT NULL`。
