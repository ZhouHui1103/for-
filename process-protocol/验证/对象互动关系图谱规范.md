# L3.5 对象互动关系图谱规范

- **版本**: 1.0
- **状态**: Draft
- **关联工作流步骤**: `STEP 4: L3.5 最终验证`

---

## 1. 核心理念

`对象互动关系图谱` (Object Interaction Map) 是对整个业务流程中数据流的最终、最细颗粒度的描绘。它的核心目的不是重复L3-SOP的流程步骤，而是**回答一个关键问题：在整个业务生命周期中，每一个核心对象的每一个关键字段，是在何时、被哪个角色、通过哪个具体流程动作进行了创建、读取、更新或删除（CRUD）操作？**

这份图谱是连接`L1业务场景`中“期望的数据故事”与`L3-SOP`中“实际执行的动作”之间的桥梁，是确保设计与实现一致性的最终验证工具。

## 2. 生成逻辑

- **输入**: 所有为特定业务场景生成的`L3-SOP`文档。
- **输出**: 一个名为 `L3.5 - 对象互动关系图谱.md` 的Markdown文件。
- **解析引擎**: 通过脚本或人工，遍历所有L3-SOP文档中的`L5`和`L6`级别的活动描述。
- **解析规则**:
    - **识别对象和字段**: 寻找被反引号 `` ` `` 包裹的文本，如 `` `服务进程` `` 或 `` `服务进程.关联订单ID` ``。
    - **识别角色**: 寻找明确的角色名称，如 `支撑运营`、`督导师` 等。
    - **识别操作**: 识别关键动词，如 `创建`、`新建`、`读取`、`查看`、`更新`、`写入`、`修改`、`删除`、`设置` 等。
    - **关联流程步骤**: 记录下该操作所在的`L4/L5/L6`步骤编号。

## 3. 输出格式与结构

图谱必须遵循以下Markdown结构：

```markdown
# 对象互动关系图谱: [业务场景名称]

---

## `对象名称1`

- **`字段名称1.1`**
    - `[流程编号]` `角色` **[操作]** 字段，[可选：描述操作细节，如值的来源]。
    - `[流程编号]` `角色` **[操作]** 字段。
- **`字段名称1.2`**
    - `[流程编号]` `角色` **[操作]** 字段。

---

## `对象名称2`

- **`字段名称2.1`**
    - `[流程编号]` `角色` **[操作]** 字段。

...
```

### 范例

```markdown
# 对象互动关系图谱: ADHD督导业务

---

## `订单信息`

- **`ID`**
    - `3.1.1` `系统` **[创建]** 字段。
    - `3.1.2` `支撑运营` **[读取]** 字段，用于创建`服务进程`。
- **`状态`**
    - `3.1.1` `系统` **[写入]** 字段，初始值为`待分配`。
    - `3.2.1` `支撑运营` **[更新]** 字段为`交付中`。

---

## `服务进程`

- **`关联订单ID`**
    - `3.1.2` `支撑运营` **[写入]** 字段，其值来源于`订单信息.ID`。
- **`状态`**
    - `3.1.2` `支撑运营` **[写入]** 字段，初始值为`待开启`。
    - `3.2.5` `督导` **[更新]** 字段为`进程中`。
    - `3.4.2` `支撑运营` **[更新]** 字段为`暂停中` (因请假)。
```

## 4. 与L1业务场景的验证规则

生成图谱后，必须根据`L1 业务场景.md`中的`验收标准`进行逐条比对。

- **验证规则**:
    - 对于L1中的每一条`字段级验收标准`（例如：“`服务进程`的`关联订单ID`字段的值必须等于触发流程的`订单信息`记录的`ID`”），**必须**能在本图谱的对应对象和字段下，找到一条或多条能够**直接证明**该标准得以实现的具体操作记录。
    - 如果L1的任何一条字段级验收标准无法在图谱中找到对应的操作记录，则认为验证失败，需要返回修改L3-SOP的设计。 