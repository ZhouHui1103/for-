# 飞书多维表格自动部署工具运行指南

## 1. 环境准备

### 1.1 安装Python
1. 访问 [Python官网](https://www.python.org/downloads/) 下载并安装Python 3.6或更高版本
2. 安装时勾选"Add Python to PATH"选项

### 1.2 安装依赖
在命令行中执行以下命令安装所需依赖：
```bash
pip install lark-oapi
```
或者使用项目中的requirements.txt文件：
```bash
pip install -r requirements.txt
```

### 1.3 准备飞书开放平台应用
1. 登录[飞书开放平台](https://open.feishu.cn/)
2. 创建一个企业自建应用
3. 获取应用的App ID和App Secret
4. 为应用开通以下权限：
   - `bitable:app:read`（读取多维表格数据权限）
   - `bitable:app:write`（写入多维表格数据权限）
5. 发布应用的最新版本

## 2. 配置脚本

1. 打开`deployer.py`文件
2. 找到配置区域（第8-14行）
3. 填入您的App ID和App Secret：
```python
APP_ID = "你的App ID"
APP_SECRET = "你的App Secret"
```

## 3. 运行脚本

### 3.1 命令行运行
1. 打开命令提示符(cmd)或PowerShell
2. 切换到项目目录：
```bash
cd 路径/到/自动化表格部署
```
3. 运行脚本：
```bash
python deployer.py
```

### 3.2 IDE运行
1. 使用Visual Studio Code、PyCharm等IDE打开项目
2. 打开`deployer.py`文件
3. 点击运行按钮执行脚本

## 4. 运行过程说明

脚本运行后会执行以下步骤：

1. **解析Markdown文件**：
   - 读取`ADHD督导业务 L3 - 飞书多维表格框架.md`文件
   - 提取表格结构和字段定义

2. **创建多维表格应用**：
   - 使用飞书API创建新的多维表格应用
   - 获取并显示app_token
   - **请务必记录此token，以便后续访问**

3. **准备表格环境**：
   - 检查默认表格，准备重用

4. **创建表格结构**：
   - 将默认表格重命名为第一个表格
   - 逐个创建其他表格
   - 显示每个表格的创建状态和ID

5. **创建字段**：
   - 为每个表格创建字段
   - 处理字段类型、选项和关联关系
   - 显示每个字段的创建状态

6. **完成部署**：
   - 显示多维表格的访问链接
   - 提示部署完成

## 5. 常见问题解决

### 5.1 权限问题
- **症状**：创建多维表格应用失败，提示权限错误
- **解决方法**：
  1. 检查App ID和App Secret是否正确
  2. 确认应用已开通`bitable:app:read`和`bitable:app:write`权限
  3. 确认应用已发布最新版本

### 5.2 表格创建失败
- **症状**：创建表格时报错
- **解决方法**：
  1. 检查网络连接
  2. 确认应用有足够的权限
  3. 查看错误信息，根据提示解决问题

### 5.3 字段创建失败
- **症状**：某些字段创建失败
- **解决方法**：
  1. 检查Markdown文件中的字段定义是否符合要求
  2. 确认字段类型是否受支持
  3. 对于关联字段，确认关联的表已经创建成功

### 5.4 脚本执行中断
- **症状**：脚本执行过程中突然中断
- **解决方法**：
  1. 检查网络连接是否稳定
  2. 查看错误信息，根据提示解决问题
  3. 重新运行脚本

## 6. 后续操作

### 6.1 访问多维表格
1. 使用脚本输出的链接访问新创建的多维表格
2. 或者使用格式：`https://x-silicon.feishu.cn/base/{APP_TOKEN}`

### 6.2 调整表格结构
如需调整表格结构：
1. 修改Markdown文件
2. 重新运行脚本创建新的多维表格
   
**注意**：脚本不支持修改已创建的表格结构，只能创建新的多维表格。

### 6.3 分享多维表格
1. 在飞书多维表格界面，点击右上角的"分享"按钮
2. 设置适当的权限，分享给团队成员

## 7. 技术支持

如遇到问题，请参考：
1. 项目文档：`README.md`和`使用说明.md`
2. 飞书API文档：[飞书开放平台文档](https://open.feishu.cn/document/ukTMukTMukTM/uUDN04SN0QjL1QDN)
