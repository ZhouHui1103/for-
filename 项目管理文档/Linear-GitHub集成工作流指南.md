# Linear & GitHub 集成工作流指南

### 引言：为何需要这套工作流？

本指南旨在为团队提供一套标准化的、深度集成 Linear 和 GitHub 的协作流程。其核心目标是**将 GitHub 强大而成熟的代码协作流程，与 Linear 高效、专注的项目管理哲学无缝结合**。

我们将分三步来理解这套机制：
1.  首先，理解作为基石的 **GitHub Flow** 是如何工作的。
2.  然后，了解 Linear 是如何“接入” GitHub 的。
3.  最后，掌握两者融合后，我们团队应遵循的**全新端到端工作流**。

---

## Part 1: 基础 - GitHub Flow 核心协作流程

在引入任何项目管理工具之前，我们首先需要理解并遵守业界广泛采纳的 **GitHub Flow** 模型。它是一套保证代码协作有序、代码质量可控的黄金标准。

其核心思想是：**保证 `main` 分支永远是稳定、可随时部署的**。

### 核心步骤

*   **第1步：`main` 分支是“真理之源”**
    *   任何在 `main` 分支上的代码，都应该是经过了审查、测试，并且可以随时部署到生产环境的。**绝不允许直接向 `main` 分支提交代码**。

*   **第2步：为新工作创建“特性分支” (Feature Branch)**
    *   当你开始一项新工作（无论是新功能还是 Bug 修复），你都必须从最新的 `main` 分支创建一个新的分支。例如 `feat/user-mention`。
    *   **这隔离了你的工作**。即使你的代码写到一半、甚至有错误，也完全不会影响到 `main` 分支的稳定性，其他同事的工作也不会被你干扰。

*   **第3步：“拉取请求” (Pull Request) 是沟通与审查的核心**
    *   当你的分支开发完成后，你不能直接将其合并回 `main` 分支。你需要创建一个 **Pull Request (PR)**。
    *   PR 的本质是一个**对话中心**。它在说：“嘿，我完成了这些代码，请大家帮忙看看有没有问题，如果没问题我就要把它合并进 `main` 分支了。”
    *   团队成员可以在 PR 里逐行评论代码、提出修改建议。这保证了**代码审查 (Code Review)** 制度的落地，是保障代码质量的关键环节。

*   **第4步：自动化守护质量 (CI/CD)**
    *   在 PR 被创建或更新时，可以自动触发一系列检查，例如：
        *   **运行自动化测试**: 确保你的修改没有破坏现有功能。
        *   **代码风格检查 (Linting)**: 保证代码风格一致。
        *   **构建 (Build)**: 确认项目可以成功编译。
    *   只有当所有检查都通过时，PR 才被允许合并。这构成了**持续集成 (Continuous Integration, CI)** 的基础。

*   **第5步：审查通过后“合并” (Merge)**
    *   当 PR 经过了同事的审查 (`Approve`) 并且所有自动化检查都通过后，你就可以将这个分支合并回 `main` 分-支了。至此，你的代码才正式成为项目的一部分。

**小结**: GitHub Flow 通过“分支隔离开发 -> PR 集中审查 -> 自动化保障质量 -> 合并进入主干”这一系列结构化的流程，保证了多人协作开发软件的效率和质量。**这是我们一切工作的基础。**

---

## Part 2: 增强 - Linear 如何与 GitHub 集成

理解了基础的 GitHub Flow 后，我们来看看 Linear 是如何作为一个“增强层”与之集成的。

这种自动化的联动，并不是什么真正的魔法，而是通过一种名为 **Webhooks（网络钩子）** 的技术实现的。你可以把它理解成一个“事件通知系统”。

*   **第一步：授权与配置**
    *   当你将 Linear 应用授权给你的 GitHub 仓库时，Linear 会在 GitHub 那边“订阅”一系列它感兴趣的事件。比如：“当有新的 PR 被创建时，请通知我”、“当一个 PR 被合并时，也请通知我”。

*   **第二步：触发联动（以创建 PR 为例）**
    1.  **开发者在 GitHub 创建 PR**: 开发者 `Alex` 创建了一个 PR，并在描述里写了 `Fixes TEAM-123`。
    2.  **GitHub 发现关键词并发起通知**: GitHub 在处理这个 PR 时，看到了 `Fixes TEAM-123` 这个关键词。它知道 `TEAM-123` 是一个外部系统（Linear）的 Issue 标识。
    3.  **GitHub 发送 Webhook**: GitHub 立刻向预先配置好的 Linear 的一个网址发送一个 HTTP 请求（这就是 Webhook）。这个请求里包含了所有信息，比如：“`Alex` 为仓库 `X-Silicon-Doc` 创建了一个 PR，标题是‘...’，它关联了 `TEAM-123`，目前状态是 `Open`。”
    4.  **Linear 接收并处理**: Linear 的服务器收到了这个通知，它解析了里面的信息，然后在其自己的数据库里，将 `TEAM-123` 这个 Issue 的状态自动更新为 `In Review`，并将 PR 的链接附加上去。

*   **第三步：完成联动（以合并 PR 为例）**
    *   流程完全一样。当 `Alex` 的 PR 在 GitHub 上被合并时，GitHub 会再次向 Linear 发送一个 Webhook 通知：“嘿，那个关联了 `TEAM-123` 的 PR 刚刚被合并了！”
    *   Linear 收到这个通知后，便自动将 `TEAM-123` 的状态更新为 `Done`。

**小结**: Linear 并非要替代 GitHub Flow，而是通过 Webhooks **监听** GitHub Flow 中的关键事件（如 PR 创建/合并），并利用关键词将这些事件与 Linear 内的 `Issue` 关联起来，从而实现项目状态的**自动同步**。

---

## Part 3: 融合 - 全新的 Linear-GitHub 集成工作流

现在，我们将前两部分结合起来，形成我们团队最终要遵循的、从“想法”到“代码合并”的完整工作流程。

### 第1步：想法的诞生与汇集 (在 Linear)

*   **场景**: 任何团队成员（产品、开发、设计）发现了一个需求、一个 Bug 或一项技术债。
*   **动作**:
    1.  在 Linear 的 `Backlog` 中创建一个 `Issue`。
    2.  清晰地描述问题，如果可能，附上相关信息（如设计稿链接、用户反馈截图）。
*   **状态**: `Backlog`

### 第2步：凝聚共识与做出承诺 (在 Linear)

这是将想法转化为可执行任务的关键一步，通常在**待办事项梳理会 (Backlog Grooming)**和**周期规划会 (Cycle Planning)**中完成。

*   **核心动作**:
    *   **讨论与澄清**: 团队共同讨论 `Backlog` 中的 `Issues`，补充细节、拆分或合并。
    *   **评估复杂度 (`Estimate`)**: 对 `Issue` 进行点数评估，以校准团队共识。
    *   **识别依赖关系**: 使用 `Issue Relations` 功能标记 `Blocked by`。
    *   **做出承诺**: 在周期规划会中，将 `Issues` 放入当前 `Cycle` 并分配负责人。
*   **状态**: `Backlog` -> `Todo`

### 第3步：开始开发 (从 Linear 到 GitHub)

*   **场景**: 开发者 `Alex` 准备开始处理分配给他的一个 `Issue`。
*   **动作**:
    1.  在 Linear 中，将该 `Issue` 的状态从 `Todo` 移动到 `In Progress`。
    2.  **关键操作**: 点击 `Issue` 详情页的 "**Create Branch**" 按钮。
        *   Linear 会自动为你创建一个遵循标准命名格式的 Git 分支，例如 `alex/TEAM-123-implement-user-mention-feature`。
        *   将这个分支 `checkout`到本地，开始编码。
*   **状态**: `Todo` -> `In Progress`
*   **解读**: 这一步是**新流程的起点**。它完美衔接了 Linear 的任务管理和 GitHub Flow 的分支开发。

### 第4步：提交审查 (从 GitHub 到 Linear)

*   **场景**: `Alex` 完成编码，准备提交审查。
*   **动作**:
    1.  `Alex` 在 GitHub 上创建一个 **Pull Request (PR)**。
    2.  **关键操作**: 在 PR 的描述中，**必须包含链接到 Linear Issue 的关键词**，如 `Fixes TEAM-123` 或 `Resolves TEAM-123`。
*   **状态 (自动变更)**: `In Progress` -> `In Review`
*   **解读**: 开发者遵循标准的 GitHub Flow 创建 PR。Linear 通过 Webhook **自动将项目状态推进**，开发者无需手动更新。

### 第5步：迭代与合并 (在 GitHub 和 Linear 之间)

*   **场景**: 同事 `Ben` 审查并批准了 PR。
*   **动作**:
    1.  `Alex` **在 GitHub 上合并 (Merge) 了这个 PR**。
*   **状态 (自动变更)**: `In Review` -> `Done`
*   **解读**: 开发者遵循标准的 GitHub Flow 合并代码。Linear 再次通过 Webhook **自动将任务标记为完成**。整个流程形成闭环。

---

## 总结：团队需遵守的黄金原则

1.  **所有工作始于 Linear Issue**: 杜绝任何没有 `Issue` 的临时性开发工作。
2.  **在 Linear 中规划，而非在聊天工具中**: 使用 `Cycles`, `Estimate` 和 `Issue Relations` 来进行结构化规划。
3.  **从 Linear 创建分支**: 这是实现自动关联的第一步，请务必使用 `Create Branch` 功能。
4.  **在 PR 描述中链接 Issue**: 这是触发自动化的核心，请务必使用 `Fixes` 等关键词。
5.  **信任自动化**: 相信工具会自动更新状态，开发者只需专注于“创建分支 -> 创建PR -> 合并PR”这一核心代码流程。
